<!DOCTYPE html><html lang="en" style="background-color: #FAFAFA;"><head>    <title>独孤九剑系统</title>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">    <link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css">    <link rel="stylesheet" href="./css/3rd/jquery.jsonview.css">    <link rel="stylesheet" href="./css/3rd/FreeSearch.css">    <link rel="stylesheet" href="./css/css.css">    <link rel="stylesheet" href="./css/defined.css">    <script src="js/3rd/jquery.js"></script>    <script src="js/3rd/jquery.jsonview.js"></script>    <script src="js/3rd/qrcode.min.js"></script>    <script src="bootstrap/js/bootstrap.min.js"></script>    <script src="js/3rd/vue.js"></script>    <script src="js/3rd/FreeSearch.js"></script>    <script src="js/api.js?v=2"></script>    <style>        .subtext{margin: 30px 0 20px}        .inputGroup{padding: 30px 0 20px;box-shadow:none}        .btn-theme{width: 100%;}        .logo{font-size: 68px;            text-shadow:0 2px 0 #fff, 0 -1px 1px #283339, 0 1px 1px #000000        }        .list-group-item{width: 100%;}        .list-group-item:focus{outline: none}        html,body{line-height: 1.7;height: 100%}        .frame{            text-align: center;            white-space: nowrap;            height: 100%;            min-height: 720px;            background: #fbffff;        }        .frame:before{            content: '';            display: inline-block;            height: 100%;            vertical-align: middle;            margin-right: -.25em;        }        .loginFrame{            padding: 0;            display: inline-block;            vertical-align: middle;            text-align: left;            white-space: normal;            margin: 0 auto;            height: 550px;            overflow: hidden;            width: 300px;            top:0;            bottom: 0;        }        .btn:focus{outline: none}        #qrcode img{            border-radius: 5px;            overflow: hidden;            box-shadow: 0 0 15px;            margin: 10px auto;        }    </style></head><body><div class="frame">    <div id="loginFrame" class="loginFrame">        <h1 class="logo text-center themesColor">            IFSYS        </h1>        <h4 class="subtext text-center">独孤九剑接口管理系统</h4>        <template v-if="isAcctAndPass">            <div class="inputGroup input-group-lg">                <input id="username" autocomplete="off" :value="username" v-model="username" class="list-group-item" type="text" placeholder="用户名">                <input id="password" autocomplete="off" :value="password" v-model="password" class="list-group-item" type="password" placeholder="密码">            </div>            <label class="control-label" for="username" style="color:{{color}}">{{notice}}</label>            <a @click="switchToQrcode" style="float: right;color: #5cb85c;cursor: pointer;"><span class="glyphicon glyphicon-qrcode"></span> 切换为微信登陆</a>            <button class="{{isLogin?'disabled':''}} btn btn-theme btn-lg btn-block" @click="login">登录 <span v-if="isLogin" class="glyphicon glyphicon-asterisk"></span></button>        </template>        <template v-if="!isAcctAndPass">            <div style="display:{{isScaled&&qrcodeHide?'none':'block'}}" id="qrcode"></div>            <div v-if="isScaled && qrcodeHide" id="wxUserInfo" style="text-align: center">                <img src="{{wxUserInfo.headimgurl}}" style="width: 180px;height: 180px;border-radius: 10px;">                <h6 class="text-center">{{wxUserInfo.nickname}}</h6>                <h6 class="text-center">{{wxUserInfo.province}}·{{wxUserInfo.city}}</h6>            </div>            <h6 class="text-center"><span v-if="isScaled" class="text-success"><span class="glyphicon glyphicon-ok-circle"></span> 扫码成功,请在手机上确认!</span><span v-if="!isScaled">请用微信扫描二维码登陆</h6>            <a v-if="isScaled" @click="ToggleQrcode" class="text-center" style="display: block;color: #35abb8;cursor: pointer;">显示/隐藏二维码</a>            <a @click="switchToAcct" class="text-center" style="display: block;color: #35abb8;cursor: pointer;">切换为账号密码登陆</a>        </template>    </div></div></body></html><script type="text/javascript" charset="UTF-8">    refreshQrcode();    var loginFrame = new Vue({        el:"#loginFrame",        data:{            notice:"",            color:"#a94442",            username:"",            password:"",            isLogin:false,            ssid:"",            isAcctAndPass:false,            wxApi:"",            isScaled:false,            wxUserInfo:null,            qrcodeHide:true        },        methods:{            login:function(){                if(!loginFrame.username)return loginFrame.notice="请输入用户名";                if(!loginFrame.password)return loginFrame.notice="请输入密码";                loginFrame.notice ="  ";                loginFrame.isLogin=true;                api.post("login.do",{userInfo: {                    loginName: loginFrame.username,                    loginPassword: loginFrame.password                }},function(data){                    location.href = "./projects.html"                },function(data){                    loginFrame.notice = data['rspInf'];                    loginFrame.isLogin = false                });                var timeId = setTimeout(function(){                    loginFrame.notice = "请求超时";                    loginFrame.isLogin = false;                },15*1000)            },            switchToAcct:function () {                loginFrame.isAcctAndPass = true            },            switchToQrcode:function () {                loginFrame.isAcctAndPass = false;                refreshQrcode(loginFrame.wxApi)            },            ToggleQrcode:function () {                loginFrame.qrcodeHide = !loginFrame.qrcodeHide;            }        }    });    // 轮训登陆状态    setInterval(function () {        if(loginFrame.isAcctAndPass) return;        refreshQrcode(loginFrame.wxApi)    },2000);    // 更新二维码    function refreshQrcode(wxApi) {        api.post("weChat/getWxLoginState.do",{},function(data){            var qrcodeBox = document.getElementById('qrcode');            var ssid = data['ssid'];            var userInfo = data['userInfo'];            var wxUserInfo = data['wxUserInfo'];            if(wxUserInfo && wxUserInfo['openid']){                loginFrame.isScaled=true;                loginFrame.wxUserInfo = wxUserInfo;            }            var _wxApi = "https://open.weixin.qq.com/connect/oauth2/authorize?" +                    "appid=wxc4ea8fd4363886bd" +                    "&redirect_uri=http%3A%2F%2Fqa.wx.shequbanjing.com/ifsys/wechat/wechartLogin.html" +                    "&response_type=code" +                    "&scope=snsapi_userinfo" +                    "&state=" +ssid+                    "#wechat_redirect";            if(wxApi != _wxApi || qrcodeBox.title==""){                loginFrame.wxApi = _wxApi;                new QRCode(qrcodeBox, loginFrame.wxApi);            }            if(userInfo && userInfo.id>0){                location.href = "./projects.html"            }        },function(data){            loginFrame.notice = data['rspInf'];            loginFrame.isLogin = false        })    }</script>